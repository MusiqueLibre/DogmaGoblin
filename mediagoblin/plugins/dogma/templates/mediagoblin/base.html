{#
# GNU MediaGoblin -- federated, autonomous media hosting
# Copyright (C) 2011, 2012 MediaGoblin contributors.  See AUTHORS.
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
-#}





    <!doctype html>
    <html
    {% block mediagoblin_html_tag %}
    {% endblock mediagoblin_html_tag %}
    >
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {# TODO : COMPRESS CSS & JS before push #}
    {# TODO : put the needed JS in the footer  #}
        <title>{% block title %}{{ app_config['html_title'] }}{% endblock %}</title>
        <link rel="stylesheet/less" type="text/css"
              href="{{ request.staticdirect('/css/normalize.less', 'coreplugin_dogma') }}"/>
        <link rel="stylesheet/less" type="text/css"
              href="{{ request.staticdirect('/css/global.less', 'coreplugin_dogma') }}"/>
        <link rel="stylesheet/less" type="text/css"
              href="{{ request.staticdirect('/css/global_mg.less', 'coreplugin_dogma') }}"/>
        <link rel="shortcut icon"
              href="{{ request.staticdirect('/images/goblin.ico', 'coreplugin_dogma') }}" />
        <script type="text/javascript">
          // Put any text that need to be translated as a variable before the script that use it

/* msg trad
          var text_not_precise_enough = "{% trans %} The postal code is incorrect, or not precise enough (e.g : you can try 75007 instead of 75000) <a id='searchPlace'>Reload</a> {% endtrans %}";
          var text_no_country = "{% trans %}You need to select a country first !{% endtrans %}";
          var text_no_result = "{%trans%}Your query returned no results. Check spelling or try a bigger city{%endtrans%}";
          var text_select_city = "{%trans%}Please select the correct city bellow{%endtrans%}";
          var text_preview = "{% trans %}Preview{% endtrans %}";
          var text_not_proper_file = "{%trans%}You can only upload audiofiles here. This file will be skipped :{%endtrans%}";
          var text_you_selected = "{%trans%}You've selected{%endtrans%}";
          var text_coordinates = "{%trans%}Coordinates{%endtrans%}";
          var undo = "{% trans %}Remove from list{% endtrans %}";
          var redo = "{% trans %}Add to list{% endtrans %}";
          var edit = "{% trans %}Edit {% endtrans %}";
          var _confirm = "{% trans %}OK{% endtrans %}";
          var cancel = "{% trans %}Cancel{% endtrans %}";
          var remove = "{% trans %}Remove{% endtrans %}";
          var restore = "{% trans %}Restore{% endtrans %}";
*/
          var text_not_precise_enough = "{% trans %} Le code postal est incorrect, ou imprècis ( vous pouvez essayer 75007 au lieu de 75000) <a id='searchPlace'>Reload</a> {% endtrans %}";
          var text_no_country = "{% trans %}Vous devez sélectionner un pays auparavant !{% endtrans %}";
          var text_no_result = "{%trans%}Votre recherche n'a donné aucun résultat. Vérifiez l'orthographe ou donnez une ville plus grande{%endtrans%}";
          var text_select_city = "{%trans%}Sélectionnez une ville ci-dessous SVP{%endtrans%}";
          var text_preview = "{% trans %}Aperçu{% endtrans %}";
          var text_not_proper_file = "{%trans%}Seuls les fichiers audios sont autorisés ici. Ce fichier a été retiré :{%endtrans%}";
          var text_you_selected = "{%trans%}Vous avez sélectionné{%endtrans%}";
          var text_coordinates = "{%trans%}Coordonnées{%endtrans%}";
          var undo = "{% trans %}Retirer de la liste{% endtrans %}";
          var redo = "{% trans %}Ajouter à la liste{% endtrans %}";
          var edit = "{% trans %}Modifier {% endtrans %}";
          var _confirm = "{% trans %}OK{% endtrans %}";
          var cancel = "{% trans %}Annuler{% endtrans %}";
          var remove = "{% trans %}Supprimer{% endtrans %}";
          var restore = "{% trans %}Sauver{% endtrans %}";


          var static_path = "{{ request.staticdirect('', 'coreplugin_dogma') }}";
        </script>
        <!-- Externale libraries -->
        <script type="text/javascript" src="{{ request.staticdirect('/js/extlib/jquery.js') }}"></script>
        <script type="text/javascript" src="{{ request.staticdirect('/js/player/projekktor.min.js', 'coreplugin_dogma') }}"></script>
        <script type="text/javascript" src="{{ request.staticdirect('/js/jquery.details.min.js', 'coreplugin_dogma') }}"></script>
        <script type="text/javascript" src="{{ request.staticdirect('/js/masonry.pkgd.min.js', 'coreplugin_dogma') }}"></script>
        <script type="text/javascript" src="{{ request.staticdirect('/js/jquery.address-1.5.min.js', 'coreplugin_dogma') }}"></script>
        <script type="text/javascript" src="{{ request.staticdirect('/js/jquery.form.min.js', 'coreplugin_dogma') }}"></script>
        <script type="text/javascript" src="http://api.geonames.org/export/geonamesData.js?username=dogmazic"></script>
        <script type="text/javascript" src="{{request.staticdirect('/js/jquery.calendarPicker.js', 'coreplugin_dogma')}}"></script>
        <script type="text/javascript" src="{{request.staticdirect('/js/jquery.mousewheel.js', 'coreplugin_dogma')}}"></script>
        <script type="text/javascript" src="{{request.staticdirect('/js/Markdown.Converter.js', 'coreplugin_dogma')}}"></script>
        <script type="text/javascript" src="{{request.staticdirect('/js/Markdown.Sanitizer.js', 'coreplugin_dogma')}}"></script>
        <script type="text/javascript" src="{{request.staticdirect('/js/Markdown.Editor.js', 'coreplugin_dogma')}}"></script>
        <!-- Homemade scripting -->
        <script type="text/javascript" src="{{ request.staticdirect('/js/global.js', 'coreplugin_dogma') }}"></script>
        <script type="text/javascript" src="{{ request.staticdirect('/js/init.js', 'coreplugin_dogma') }}"></script>
        {% include "dogma/less/less_process.html" %}

        {# For clarification, the difference between the extra_head.html template
         # and the head template hook is that the former should be used by
         # themes and the latter should be used by plugins.
         # The reason is that only one thing can override extra_head.html...
         # but multiple plugins can hook into the template hook.
         #}
        {#% include "mediagoblin/extra_head.html" %#}
        {% template_hook("head") %}

        {% block mediagoblin_head %}
        {% endblock mediagoblin_head %}
      </head>
      <body>
        {% block mediagoblin_body %}
          {% block mediagoblin_header %}
            <header id="main_header">
                <section id="global_menu_container" class="menu_container">
                  <nav id="global_nav">
                      <h1 id="main_title" class="out_of_the_way">Menu general pour les sites de musique libre !</h1>
                      <ul id="global_menu" class="global_menu">
                        <li id="main_logo_container">
                          <a href="/" ><img id="main_logo" src="{{ request.staticdirect('/images/coomutel_ogo_min.png', 'coreplugin_dogma') }}"/>CO<span style="color:#990C0C">O</span>MUTE</a>
                        </li>
                        <li class="global_menu_list">
                            <a href="http://musique-libre.org" id="menu_blog" class="menu_more global_menu_link">Blog</a>
                        </li>
                        <li class="global_menu_list non_site">
                            <a href="http://musique-libre.org/?page_id=285" class="global_menu_contact" id="global_menu_contact">Contact</a>
                        </li>
                        <li id="main_connection">
                          <div id="connection_menu">
                            {% if request.user %}
                                  {% if request.user and 
                                      request.user.has_privilege('active') and 
                                      not request.user.is_banned() %}
                                    {% set notification_count = get_notification_count(request.user.id) %}
                                    {% if notification_count %}
                                      {{ notification_count }}
                                    {% endif %}
                                    <a href="{{ request.urlgen('mediagoblin.edit.account') }}">
                                      {{ request.user.username }}
                                    </a>
                                    <a class="buttonified darker_button" href="{{ request.urlgen('mediagoblin.plugins.dogma.dashboard') }}">
                                     {%- trans %}Dashboard{% endtrans -%}
                                    </a> 
                                  {# the following link should only appear when verification is needed #}
                                  {% elif request.user and not request.user.has_privilege('active') %}
                                        <a href="{{ request.urlgen('mediagoblin.user_pages.user_home',
                                                         user=request.user.username) }}"
                                           class="button_action_highlight">
                                       {% trans %}Verify your email!{% endtrans %}</a>
                              {% endif %}
                                  <a href="{{ request.urlgen('mediagoblin.auth.logout') }}">{% trans %}log out{% endtrans %}</a>
                            {% else %}
                                <a id="subscribe_link" href="{{ request.urlgen('mediagoblin.auth.register')  }}">{% trans %}Register{% endtrans %}</a>
                                <button type="button" id="connection_button">
                                  {%- trans %}Log in{% endtrans -%}
                                </button>
                            {% endif %}
                          </div>
                        </li>
                        <li  id="main_player_container">
                          <audio id="main_player" title="{% trans %}Choose some libre music!!!{% endtrans %}"></audio>
                          <div class="sub_menu_container">
                            <ul id="current_playlist"> </ul>
                          </div>
                          <button type="button" class="header_button menu_more_button">{% trans %}Playlist{% endtrans %}</button>
                        </li>
                      </ul>
                  </nav>
                </section>
                {% block mediagoblin_header_title %}{% endblock %}
               <section id="site_infos">
                 <h1 id="site_title"><a href="{{ request.urlgen('index') }}" id="site_title_link">Coomute Music</a></h1>
                 <div id="site_description">{% trans %}A new species of music sharers{% endtrans %}</div>
               </section>
            </header>
          {% endblock %}
          <main class="container" id="main_content_full">
              {% include "mediagoblin/utils/messages.html" %}
              {% block mediagoblin_content %}
              {% endblock mediagoblin_content %}
             <!-- Display enhancment JS  -->
          </main>
          <aside id="player_helper">
            <div class="player_notif" id="player_notif_t_added">{% trans %} Track<br/> added ! {% endtrans %}</div>
            <div class="player_notif" id="player_notif_a_added">{% trans %} Album added ! {% endtrans %}</div>
            <ul id="player_remote" class="control_bar bullet_less">
              <li class="bullet_less player_control"><button type="button"  id="remote_play">&#9654;</button><button type="button"  id="remote_pause">&#9646;&#9646;</button></li>
              <li class="bullet_less player_control"><button type="button"  id="remote_prev">&#9027;</button> <button type="button" id="remote_next" >&#9028;</button></li>
            </ul>
            <br/>
            <button type="button" id="go_to_player"> {% trans %}player{% endtrans %}</button>
            <button type="button"  id="go_to_playlist"> {% trans %}playlist{% endtrans %}</button>
          </aside>
          {%- block mediagoblin_footer %}
              <footer id="footer">
                  <a class="pretty_font" id="footer_bug_repport"  target="_blank" href="https://github.com/MusiqueLibre/dogmagoblin/issues?state=open">
                      {% trans %}Problem ?{% endtrans %}
                      <img title="{% trans %} Report Bug {% endtrans %}" src="{{ request.staticdirect('/images/bugpng.png', 'coreplugin_dogma') }}"/>
                      {% trans %}Report !{% endtrans %}
                  </a>
                {% trans source_link=app_config['source_link'] -%}
                  Distribué sous licence <a href="http://www.fsf.org/licensing/licenses/agpl-3.0.html">AGPL</a>. <a href="{{ source_link }}">Code source </a> disponible.
                {%- endtrans %}
                
              </footer>
          {%- endblock mediagoblin_footer %}
      {%- endblock mediagoblin_body %}
    </body>
  </html>
